import statbotics
import csv

sb = statbotics.Statbotics()
teamlist = [
    2337, 3620, 4391, 862, 67, 3572, 5460, 3538, 2832, 2767, 33, 6002,
    10589, 5216, 3656, 1023, 2137, 2075, 7197, 494, 1718, 27, 3767, 6615,
    2054, 5505, 3536, 70, 7166, 1506, 3655, 5675, 5166, 7790, 4776, 7196,
    4237, 7769, 8608, 3539, 469, 910, 7211, 1076, 245, 4967, 2960, 1481,
    4453, 9245, 2145, 3668, 4398, 3175, 3546, 1918, 302, 10505, 2834,
    1701, 818, 5907, 1189, 226, 1684, 6120, 7768, 8873, 217, 5436, 3770,
    10654, 5352, 10606, 1025, 1188, 4405, 8352, 5530, 4375, 6637, 4381,
    815, 10349, 4680, 10666, 2619, 4422, 8517, 7656, 3414, 9776, 548,
    5314, 10633, 4003, 6029, 3604, 6570, 5660, 4998, 247, 9558, 5152,
    1711, 7174, 7056, 6861, 6033, 5534, 5577, 5110, 141, 858, 8397, 6088,
    51, 5114, 6618, 6548, 5150, 5559, 5538, 2851, 3875, 2620, 2586, 6077,
    8280, 9312, 7220, 2611, 68, 5843, 573, 4377, 66, 6344, 9673, 3322,
    5066, 5712, 5509, 7501, 1498, 9685, 5535, 7782, 857, 3357, 5695,
    2771, 4855, 5547, 1502, 201, 107, 3603, 9255, 4327
]

ranked = []

for i in range(len(teamlist)):
    stats = sb.get_team_year(teamlist[i], 2025)
    epa = stats.get("epa", {}).get("norm", 0.0)
    epa_team = (epa,teamlist[i])
    ranked.append(epa_team)

eparank = sorted(ranked, key=lambda tup: tup[0], reverse=True)
print(eparank)


filename = "2025fim_dcmp.csv"

with open(filename, 'w', newline='') as file:
    writer = csv.writer(file)
    writer.writerows(eparank)
